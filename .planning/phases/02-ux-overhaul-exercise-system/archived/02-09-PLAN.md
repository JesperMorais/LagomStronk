---
phase: 02-ux-overhaul-exercise-system
plan: 09
type: execute
wave: 4
depends_on: ["02-08"]
files_modified:
  - js/app.js
  - js/ui/dashboard/hero.js
  - js/ui/dashboard/volumeChart.js
  - js/ui/dashboard/prCards.js
  - js/ui/components/miniPlayer.js
  - js/ui/components/numpad.js
  - css/dashboard.css
  - css/numpad.css
  - index.html
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "New workout creates empty workout, starts timer, auto-names 'My Workout #X'"
    - "Exercise picker opens as separate screen, not landing page"
    - "Mini-player ALWAYS visible when workout active (Spotify-style)"
    - "This Week and Recent PRs are side-by-side, half width each"
    - "Landing page has only stats row + floating start workout FAB"
    - "Numpad uses mint color with glow, not blue"
    - "Plate calculator button above NEXT on numpad"
    - "Add Custom Exercise in better UX position (not bottom)"
  artifacts:
    - path: "js/app.js"
      provides: "Fixed workout flow and dashboard layout"
    - path: "css/numpad.css"
      provides: "Mint-themed numpad with glow"
---

<objective>
Fix UX issues identified during Phase 2 verification. Major changes to workout creation flow, dashboard layout, mini-player persistence, and numpad styling.

This is a gap closure plan addressing verification feedback.
</objective>

<context>
Issues identified:
1. Workout creation flow broken - should create empty workout with timer immediately
2. Exercise screen incorrectly used as landing - should be separate screen
3. Mini-player not always showing when workout active
4. Dashboard too cluttered - need simplified side-by-side layout
5. Numpad wrong color (blue instead of mint) and missing plate calculator
6. Add Custom Exercise button poorly placed
7. Need to pull latest exercise format from main branch
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix workout creation flow</name>
  <files>js/app.js</files>
  <action>
Update workout creation:

1. When user taps FAB "Start Workout":
   - Create empty workout object with `name: "My Workout #${nextNumber}"` (auto-increment)
   - Set `startTime: Date.now()`
   - Set `exercises: []`
   - Save to appData immediately
   - Start workout timer
   - Show mini-player immediately
   - Stay on dashboard (don't navigate to exercise picker)

2. Add "Add Exercise" button within the active workout section on dashboard

3. Exercise picker should be a modal/screen that opens on demand, not the landing state

4. Pull latest exercise format from main branch and ensure data.js uses it
  </action>
</task>

<task type="auto">
  <name>Task 2: Make mini-player always visible during active workout</name>
  <files>js/ui/components/miniPlayer.js, js/app.js, css/workout.css</files>
  <action>
Fix mini-player behavior:

1. Mini-player shows on ALL screens when workout is active (not just when navigating away)
2. Spotify-style: always at bottom, shows workout name + timer + up arrow
3. Up arrow indicates expandable - tap to go to workout detail
4. Timer updates every second
5. Mini-player should be visible on: Dashboard, History, Library, Progress, Settings
6. Only hide when no active workout

Update switchView() to NOT hide mini-player when workout active.
  </action>
</task>

<task type="auto">
  <name>Task 3: Simplify dashboard layout - side-by-side stats</name>
  <files>js/ui/dashboard/volumeChart.js, js/ui/dashboard/prCards.js, css/dashboard.css, index.html</files>
  <action>
Redesign dashboard:

1. Remove hero section (streak moves elsewhere or simplifies)

2. Create compact side-by-side layout:
   ```
   [This Week (50%)] [Recent PRs (50%)]
   ```

3. "This Week" card:
   - Compact mini bar chart (smaller, cleaner)
   - Show total volume as big number
   - 7 small bars for each day
   - Customizable goal line
   - Settings gear to customize goal

4. "Recent PRs" card:
   - Show 1-2 most recent PRs
   - Compact format: "Bench Press ðŸ’ª 100kg"
   - "View all" link if more PRs

5. Below cards: ONLY the floating FAB "Start Workout" with mint glow

6. Remove any other content from landing page (cleaner is better)

7. Make charts visually stunning but compact
  </action>
</task>

<task type="auto">
  <name>Task 4: Fix numpad styling and add plate calculator</name>
  <files>js/ui/components/numpad.js, css/numpad.css</files>
  <action>
Update numpad:

1. Change NEXT button from blue (#4A90D9) to mint (var(--mint))
2. Add glow effect to NEXT button (box-shadow like FAB)
3. Settings button (above NEXT) becomes Plate Calculator button
4. Plate calculator icon: weight plate or scale icon
5. On tap: show plate calculator modal (can be placeholder for now)
6. Ensure all numpad colors match mint theme
7. Add subtle glow to active/pressed states
  </action>
</task>

<task type="auto">
  <name>Task 5: Improve Add Custom Exercise UX</name>
  <files>js/app.js, index.html, css/library.css</files>
  <action>
Better placement for Add Custom Exercise:

Options (implement best one):
1. FAB in bottom-right of library view (like dashboard)
2. "+" button in library header next to search
3. Empty state CTA when no results match search
4. All three for discoverability

Remove from bottom of scrollable list - that's poor UX.

The wizard itself is good, just needs better entry points.
  </action>
</task>

<task type="auto">
  <name>Task 6: Pull and integrate latest exercise data</name>
  <files>js/data/exercises.js, js/data.js</files>
  <action>
1. Check main branch for latest DEFAULT_EXERCISES or EXERCISES format
2. If different from current, update js/data/exercises.js
3. Ensure backward compatibility with existing user data
4. Verify muscle group mappings are complete
  </action>
</task>

</tasks>

<verification>
1. Tap FAB â†’ Empty "My Workout #1" created, timer starts, mini-player shows
2. Navigate to History â†’ Mini-player still visible at bottom
3. Navigate to Library â†’ Mini-player still visible
4. Dashboard shows side-by-side This Week | Recent PRs
5. Dashboard has only stats row + FAB (no other clutter)
6. Numpad NEXT button is mint with glow
7. Numpad has plate calculator button (above NEXT)
8. Add Custom Exercise accessible from library header or FAB
9. No console errors
</verification>

<success_criteria>
- Empty workout creation with auto-naming works
- Mini-player persistent across all views when workout active
- Dashboard is clean with side-by-side compact stats
- Numpad is mint-themed with glow
- Plate calculator button present on numpad
- Add Custom Exercise has better UX entry point
- Latest exercise data format in use
</success_criteria>

<output>
After completion, create `.planning/phases/02-ux-overhaul-exercise-system/02-09-SUMMARY.md`
</output>

---
phase: 03-workout-features
plan: 01
type: execute
---

<objective>
Create training programs data model and core logic for multi-week structured training.

Purpose: Enable users to follow organized training programs (PPL, 5x5, Upper/Lower) with scheduled workouts.
Output: Program data structures, storage, active program state management, and helper functions.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-workout-features/03-CONTEXT.md

**Existing infrastructure:**
@js/data.js - Has workout templates (Push/Pull/Leg/Upper/Full Body), PR functions, exercise history
@js/app.js - 2864 lines, manages app state and UI

**Key existing patterns:**
- Workout templates: { id, name, isDefault, exercises: [{name, sets, reps}] }
- Data storage: localStorage via loadData()/saveData()
- generateId() for unique IDs

**Phase 2 decisions:**
- Mini-player shows active workout, auto-starts on first exercise
- FAB starts empty workout
- Dashboard shows streak, volume chart, stat cards
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define program templates and data structures</name>
  <files>js/data.js</files>
  <action>
Add training program data structures to data.js:

1. PROGRAM_TEMPLATES constant with 6-8 programs:
   - PPL (Push/Pull/Legs) - 6 day cycle
   - 5x5 (StrongLifts style) - A/B alternating
   - Upper/Lower - 4 day split
   - Bro Split - 5 day (Chest/Back/Shoulders/Arms/Legs)
   - Full Body 3x - 3 days per week
   - PHUL (Power/Hypertrophy Upper Lower) - 4 day

2. Program structure:
```javascript
{
  id: 'ppl',
  name: 'Push Pull Legs',
  description: 'Classic 6-day hypertrophy split',
  daysPerWeek: 6,
  schedule: [
    { day: 1, workout: 'push-day', label: 'Push' },
    { day: 2, workout: 'pull-day', label: 'Pull' },
    { day: 3, workout: 'leg-day', label: 'Legs' },
    { day: 4, workout: 'push-day', label: 'Push' },
    { day: 5, workout: 'pull-day', label: 'Pull' },
    { day: 6, workout: 'leg-day', label: 'Legs' }
  ],
  workouts: {
    'push-day': { name: 'Push', exercises: [...] },
    'pull-day': { name: 'Pull', exercises: [...] },
    'leg-day': { name: 'Legs', exercises: [...] }
  },
  tips: 'Rest on day 7, repeat cycle'
}
```

3. Active program state structure:
```javascript
{
  programId: 'ppl',
  startDate: '2026-02-01',
  currentDay: 4,
  completedDays: ['2026-02-01', '2026-02-02', '2026-02-03'],
  lastWorkoutDate: '2026-02-03',
  customizations: {} // exercise swaps, weight adjustments
}
```

Use existing workout template exercises where possible. Define DEFAULT_ACTIVE_PROGRAM = null.
  </action>
  <verify>grep -c "PROGRAM_TEMPLATES" js/data.js returns 1</verify>
  <done>PROGRAM_TEMPLATES constant with 6 programs defined, activeProgram structure documented</done>
</task>

<task type="auto">
  <name>Task 2: Add program management functions</name>
  <files>js/data.js</files>
  <action>
Add exported functions for program management:

1. getPrograms() - Return all available program templates
2. getProgramById(programId) - Get specific program
3. getActiveProgram(data) - Get current active program state from data
4. setActiveProgram(data, programId) - Start a program (sets startDate to today, currentDay to 1)
5. endActiveProgram(data) - End current program (clears active state)
6. getTodaysProgrammedWorkout(data) - Returns today's scheduled workout based on active program and schedule
7. advanceProgramDay(data) - Increment currentDay after completing a workout
8. skipProgramDay(data) - Skip today and advance (for missed days)
9. getProgramProgress(data) - Return { currentDay, totalDays, percentComplete, daysCompleted }

Key logic for getTodaysProgrammedWorkout:
- If no active program, return null
- Calculate which day in schedule based on (currentDay % schedule.length)
- Return the workout template for that day
- Include hint about what's next

Add activeProgram to getDefaultData() return value (default null).
Ensure loadData() handles missing activeProgram gracefully.
  </action>
  <verify>grep "getTodaysProgrammedWorkout" js/data.js && grep "setActiveProgram" js/data.js</verify>
  <done>All 9 program management functions exported and working</done>
</task>

<task type="auto">
  <name>Task 3: Add progressive overload helpers</name>
  <files>js/data.js</files>
  <action>
Add functions for intelligent suggestions:

1. getProgressiveOverloadSuggestion(data, exerciseName) - Returns weight suggestion based on history:
   - Look at last 3 workouts for this exercise
   - If user completed all sets at current weight with target reps, suggest +2.5kg
   - If user failed to complete sets, suggest staying at same weight
   - Return { suggestedWeight, reason, lastWeight, trend: 'increase'|'maintain'|'decrease' }

2. getMissedMuscleGroups(data, daysBack = 7) - Returns muscle groups not trained recently:
   - Analyze last N days of workouts
   - Compare against exercise metadata primaryMuscles
   - Return array of { muscleGroup, daysSinceTrained, suggestion: 'Consider adding...' }

3. getProgramAdherence(data) - Calculate how well user is following program:
   - Compare scheduled vs actual workouts
   - Return { adherencePercent, missedDays, extraWorkouts, streak }

These provide data for "coach-like guidance" mentioned in context.
  </action>
  <verify>grep "getProgressiveOverloadSuggestion" js/data.js && grep "getMissedMuscleGroups" js/data.js</verify>
  <done>Progressive overload and missed muscle detection functions working</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] PROGRAM_TEMPLATES contains at least 6 programs
- [ ] getActiveProgram/setActiveProgram work correctly
- [ ] getTodaysProgrammedWorkout returns correct workout based on program schedule
- [ ] getProgressiveOverloadSuggestion returns sensible suggestions
- [ ] No JavaScript errors when loading data.js
</verification>

<success_criteria>
- All tasks completed
- Program data model supports PPL, 5x5, Upper/Lower, Bro Split, Full Body, PHUL
- Helper functions provide foundation for intelligent suggestions
- Ready for UI implementation in Plan 03-02
</success_criteria>

<output>
After completion, create `.planning/phases/03-workout-features/03-01-SUMMARY.md`
</output>
